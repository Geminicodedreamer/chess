{"ast":null,"code":"import ContentBase from '../components/ContentBase';\nimport UserProfileInfo from '../components/UserProfileInfo';\nimport UserProfilePosts from '../components/UserProfilePosts';\nimport UserProfileWrite from '../components/UserProfileWrite';\nimport { reactive } from 'vue';\nimport { useRoute } from 'vue-router';\nimport $ from 'jquery';\nimport { useStore } from 'vuex';\nimport { computed } from 'vue';\nexport default {\n  name: 'UserProfile',\n  components: {\n    ContentBase,\n    UserProfileInfo,\n    UserProfilePosts,\n    UserProfileWrite\n  },\n\n  setup() {\n    const store = useStore();\n    const route = useRoute();\n    const userId = parseInt(route.params.userId); // console.log(userId);\n    //user 一般不会变，可以用reactive\n\n    const user = reactive({\n      /* id:1,\r\n       username:\"小米汽车\",\r\n       lastName:\"小米\",\r\n       firstName:\"汽车\",\r\n       followerCount:\"100\",\r\n       is_followed:false,//是否关注,false:未关注，true：已关注*/\n    });\n    const posts = reactive({\n      /*count:3,//帖子数量\r\n      posts:[\r\n        {\r\n          id:1,\r\n          userId:1,\r\n          content:\"小米12s系列，徕卡影像，7月4日见\"\r\n          },\r\n        {\r\n          id:2,\r\n          userId:1,\r\n          content:\"小米手环7Pro，时尚新选择，7月4日见\"\r\n          },\r\n        {\r\n          id:3,\r\n          userId:1,\r\n          content:\"小米汽车c1，性价比轿跑，7月4日见\"\r\n          },\r\n      \r\n          ]*/\n    });\n    $.ajax({\n      url: \"https://app165.acapp.acwing.com.cn/myspace/getinfo/\",\n      type: \"GET\",\n      data: {\n        user_id: userId\n      },\n      headers: {\n        'Authorization': \"Bearer \" + store.state.user.access\n      },\n\n      success(resp) {\n        user.id = resp.id;\n        user.username = resp.username;\n        user.photo = resp.photo;\n        user.followerCount = resp.followerCount;\n        user.is_followed = resp.is_followed; //指的是当前登录的用户是否关注当前正在看的用户\n        //console.log(resp);\n      },\n\n      error() {\n        console.log(\"failed\");\n      }\n\n    });\n    $.ajax({\n      url: \"https://app165.acapp.acwing.com.cn/myspace/post/\",\n      type: \"GET\",\n      data: {\n        user_id: userId\n      },\n      headers: {\n        'Authorization': \"Bearer \" + store.state.user.access\n      },\n\n      success(resp) {\n        posts.count = resp.length;\n        posts.posts = resp; //console.log(resp);\n      },\n\n      error() {\n        console.log(\"failed\");\n      }\n\n    });\n\n    const follow = () => {\n      if (user.is_followed) return; //已经关注就无需重复关注\n\n      user.is_followed = true;\n      user.followerCount++;\n    };\n\n    const unfollow = () => {\n      if (!user.is_followed) return; //已经取消关注就无需取消关注\n\n      user.is_followed = false; //否则取消关注并且关注数减一\n\n      user.followerCount--;\n    }; //发布一个帖子\n\n\n    const post_a_post = content => {\n      posts.count++;\n      posts.posts.unshift({\n        id: posts.count,\n        userId: 1,\n        content: content\n      });\n    }; //删除一个帖子\n\n\n    const delete_a_post = post_id => {\n      posts.posts = posts.posts.filter(posts => posts.id != post_id); //过滤，判断该元素是否应该被保留下来\n\n      posts.count = posts.posts.length;\n    };\n    /*const change_a_post=(post_id)=>{\r\n      };*/\n    //判断当前页面是不是自己\n    //console.log(typeof(userId),typeof(store.state.user.id));\n\n\n    const is_me = computed(() => userId === store.state.user.id);\n    return {\n      user,\n      follow,\n      unfollow,\n      posts,\n      post_a_post,\n      delete_a_post,\n      is_me\n    };\n  }\n\n};","map":{"version":3,"mappings":"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","names":["ContentBase","UserProfileInfo","UserProfilePosts","UserProfileWrite","reactive","useRoute","$","useStore","computed","name","components","setup","store","route","userId","parseInt","params","user","posts","ajax","url","type","data","user_id","headers","state","access","success","resp","id","username","photo","followerCount","is_followed","error","console","log","count","length","follow","unfollow","post_a_post","content","unshift","delete_a_post","post_id","filter","is_me"],"sourceRoot":"","sources":["C:\\Users\\DELL\\Desktop\\chess\\myspace\\src\\views\\UserProfileView.vue"],"sourcesContent":["<template>\r\n \r\n<ContentBase>\r\n    <div class=\"row\">\r\n      <div class=\"col-3\">\r\n        <UserProfileInfo @follow=\"follow\" @unfollow=\"unfollow\" :user=\"user\"/>\r\n        <!--如果是自己才显示编辑模块-->\r\n        <UserProfileWrite v-if=\"is_me\" @post_a_post=\"post_a_post\"/>\r\n      </div>\r\n        <div class=\"col-9\">帖子列表\r\n          <!--将user和posts传进来-->\r\n          <UserProfilePosts :user=\"user\" :posts=\"posts\" @delete_a_post=\"delete_a_post\"/>\r\n        </div>\r\n    </div>\r\n\r\n</ContentBase>\r\n\r\n</template>\r\n\r\n<script>\r\n\r\nimport ContentBase from '../components/ContentBase';\r\nimport UserProfileInfo from '../components/UserProfileInfo';\r\nimport UserProfilePosts from '../components/UserProfilePosts';\r\nimport UserProfileWrite from '../components/UserProfileWrite';\r\nimport {reactive} from 'vue';\r\nimport { useRoute } from 'vue-router';\r\nimport $ from 'jquery';\r\nimport { useStore } from 'vuex';\r\nimport {computed} from 'vue';\r\n\r\n\r\nexport default {\r\n  name: 'UserProfile',\r\n  components: {\r\n    ContentBase,\r\n    UserProfileInfo,\r\n    UserProfilePosts,\r\n    UserProfileWrite,\r\n\r\n\r\n  },\r\n  setup(){\r\n    const store=useStore();\r\n\r\n    const route=useRoute();\r\n    const userId=parseInt(route.params.userId);\r\n   // console.log(userId);\r\n   //user 一般不会变，可以用reactive\r\n    const user=reactive({\r\n     /* id:1,\r\n      username:\"小米汽车\",\r\n      lastName:\"小米\",\r\n      firstName:\"汽车\",\r\n      followerCount:\"100\",\r\n      is_followed:false,//是否关注,false:未关注，true：已关注*/\r\n\r\n\r\n    });\r\n    const posts=reactive({\r\n      /*count:3,//帖子数量\r\n      posts:[\r\n        {\r\n          id:1,\r\n          userId:1,\r\n          content:\"小米12s系列，徕卡影像，7月4日见\"\r\n\r\n        },\r\n        {\r\n          id:2,\r\n          userId:1,\r\n          content:\"小米手环7Pro，时尚新选择，7月4日见\"\r\n\r\n        },\r\n        {\r\n          id:3,\r\n          userId:1,\r\n          content:\"小米汽车c1，性价比轿跑，7月4日见\"\r\n\r\n        },\r\n\r\n\r\n\r\n\r\n\r\n\r\n      ]*/\r\n\r\n    });\r\n    $.ajax({\r\n      url:\"https://app165.acapp.acwing.com.cn/myspace/getinfo/\",\r\n      type:\"GET\",\r\n      data:{\r\n        user_id:userId,\r\n\r\n      },\r\n      headers:{\r\n        'Authorization': \"Bearer \" +store.state.user.access,\r\n      },\r\n      success(resp){\r\n        user.id=resp.id;\r\n        user.username=resp.username;\r\n        user.photo=resp.photo;\r\n        user.followerCount=resp.followerCount;\r\n        user.is_followed=resp.is_followed;//指的是当前登录的用户是否关注当前正在看的用户\r\n        //console.log(resp);\r\n      },\r\n      error(){\r\n        console.log(\"failed\");\r\n      }\r\n\r\n\r\n    });\r\n    $.ajax({\r\n      url:\"https://app165.acapp.acwing.com.cn/myspace/post/\",\r\n      type:\"GET\",\r\n      data:{\r\n        user_id:userId\r\n      },\r\n      headers:{\r\n        'Authorization': \"Bearer \" +store.state.user.access,\r\n      },\r\n      success(resp){\r\n        posts.count=resp.length;\r\n        posts.posts=resp;\r\n        //console.log(resp);\r\n      },\r\n      error(){\r\n        console.log(\"failed\");\r\n      }\r\n\r\n\r\n    });\r\n    const follow=()=>{\r\n      if(user.is_followed)return;//已经关注就无需重复关注\r\n      user.is_followed=true;\r\n      user.followerCount++;\r\n\r\n    };\r\n    const unfollow=()=>{\r\n      if(!user.is_followed)return;//已经取消关注就无需取消关注\r\n      user.is_followed=false;//否则取消关注并且关注数减一\r\n      user.followerCount--;\r\n\r\n    };\r\n    //发布一个帖子\r\n    const post_a_post=(content)=>{\r\n      posts.count++;\r\n      posts.posts.unshift({\r\n        id:posts.count,\r\n        userId:1,\r\n        content:content,\r\n      })\r\n    };\r\n    //删除一个帖子\r\n    const delete_a_post=(post_id)=>{\r\n      posts.posts=posts.posts.filter(posts=>posts.id!=post_id);//过滤，判断该元素是否应该被保留下来\r\n      posts.count=posts.posts.length;\r\n\r\n\r\n\r\n    };\r\n    /*const change_a_post=(post_id)=>{\r\n\r\n    };*/\r\n\r\n    //判断当前页面是不是自己\r\n    //console.log(typeof(userId),typeof(store.state.user.id));\r\n    const is_me=computed(()=>userId===store.state.user.id);\r\n    return {\r\n      user,\r\n      follow,\r\n      unfollow,\r\n      posts,\r\n      post_a_post,\r\n      delete_a_post,\r\n      is_me,\r\n\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}