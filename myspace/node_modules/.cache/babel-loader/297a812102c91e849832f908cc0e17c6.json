{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, withCtx as _withCtx } from \"vue\";\nconst _hoisted_1 = {\n  class: \"row\"\n};\nconst _hoisted_2 = {\n  class: \"col-3\"\n};\nconst _hoisted_3 = {\n  class: \"col-9\"\n};\n\nconst _hoisted_4 = /*#__PURE__*/_createTextVNode(\"帖子列表 \");\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_UserProfileInfo = _resolveComponent(\"UserProfileInfo\");\n\n  const _component_UserProfileWrite = _resolveComponent(\"UserProfileWrite\");\n\n  const _component_UserProfilePosts = _resolveComponent(\"UserProfilePosts\");\n\n  const _component_ContentBase = _resolveComponent(\"ContentBase\");\n\n  return _openBlock(), _createBlock(_component_ContentBase, null, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_UserProfileInfo, {\n      onFollow: $setup.follow,\n      onUnfollow: $setup.unfollow,\n      user: $setup.user\n    }, null, 8, [\"onFollow\", \"onUnfollow\", \"user\"]), $setup.is_me ? (_openBlock(), _createBlock(_component_UserProfileWrite, {\n      key: 0,\n      onPost_a_post: $setup.post_a_post\n    }, null, 8, [\"onPost_a_post\"])) : _createCommentVNode(\"\", true)]), _createElementVNode(\"div\", _hoisted_3, [_hoisted_4, _createVNode(_component_UserProfilePosts, {\n      user: $setup.user,\n      posts: $setup.posts,\n      onDelete_a_post: $setup.delete_a_post\n    }, null, 8, [\"user\", \"posts\", \"onDelete_a_post\"])])])]),\n    _: 1\n  });\n}","map":{"version":3,"mappings":";;EAGSA,KAAK,EAAC;;;EACJA,KAAK,EAAC;;;EAKJA,KAAK,EAAC;;;iDAAQ;;;;;;;;;;;uBAP3BC,aAacC,sBAbd,EAac,IAbd,EAac;sBAZV,MAUM,CAVNC,oBAUM,KAVN,cAUM,CATJA,oBAIM,KAJN,cAIM,CAHJC,aAAqEC,0BAArE,EAAqE;MAAnDC,QAAM,EAAEC,aAA2C;MAAlCC,UAAQ,EAAED,eAAwB;MAAbE,IAAI,EAAEF;IAAO,CAArE,8CAGI,EADoBA,8BAAxBN,aAA2DS,2BAA3D,EAA2D;YAAA;MAA3BC,aAAW,EAAEJ;IAAc,CAA3D,8DACI,CAJN,CASI,EAJFJ,oBAGM,KAHN,cAGM,aADJC,aAA8EQ,2BAA9E,EAA8E;MAA3DH,IAAI,EAAEF,WAAqD;MAA9CM,KAAK,EAAEN,YAAuC;MAA/BO,eAAa,EAAEP;IAAgB,CAA9E,gDACI,CAHN,CAIE,CAVN,CAUM,EAEI;;EAAA,CAbd","names":["class","_createBlock","_component_ContentBase","_createElementVNode","_createVNode","_component_UserProfileInfo","onFollow","$setup","onUnfollow","user","_component_UserProfileWrite","onPost_a_post","_component_UserProfilePosts","posts","onDelete_a_post"],"sourceRoot":"","sources":["C:\\Users\\DELL\\Desktop\\chess\\myspace\\src\\views\\UserProfileView.vue"],"sourcesContent":["<template>\r\n \r\n<ContentBase>\r\n    <div class=\"row\">\r\n      <div class=\"col-3\">\r\n        <UserProfileInfo @follow=\"follow\" @unfollow=\"unfollow\" :user=\"user\"/>\r\n        <!--如果是自己才显示编辑模块-->\r\n        <UserProfileWrite v-if=\"is_me\" @post_a_post=\"post_a_post\"/>\r\n      </div>\r\n        <div class=\"col-9\">帖子列表\r\n          <!--将user和posts传进来-->\r\n          <UserProfilePosts :user=\"user\" :posts=\"posts\" @delete_a_post=\"delete_a_post\"/>\r\n        </div>\r\n    </div>\r\n\r\n</ContentBase>\r\n\r\n</template>\r\n\r\n<script>\r\n\r\nimport ContentBase from '../components/ContentBase';\r\nimport UserProfileInfo from '../components/UserProfileInfo';\r\nimport UserProfilePosts from '../components/UserProfilePosts';\r\nimport UserProfileWrite from '../components/UserProfileWrite';\r\nimport {reactive} from 'vue';\r\nimport { useRoute } from 'vue-router';\r\nimport $ from 'jquery';\r\nimport { useStore } from 'vuex';\r\nimport {computed} from 'vue';\r\n\r\n\r\nexport default {\r\n  name: 'UserProfile',\r\n  components: {\r\n    ContentBase,\r\n    UserProfileInfo,\r\n    UserProfilePosts,\r\n    UserProfileWrite,\r\n\r\n\r\n  },\r\n  setup(){\r\n    const store=useStore();\r\n\r\n    const route=useRoute();\r\n    const userId=parseInt(route.params.userId);\r\n   // console.log(userId);\r\n   //user 一般不会变，可以用reactive\r\n    const user=reactive({\r\n     /* id:1,\r\n      username:\"小米汽车\",\r\n      lastName:\"小米\",\r\n      firstName:\"汽车\",\r\n      followerCount:\"100\",\r\n      is_followed:false,//是否关注,false:未关注，true：已关注*/\r\n\r\n\r\n    });\r\n    const posts=reactive({\r\n      /*count:3,//帖子数量\r\n      posts:[\r\n        {\r\n          id:1,\r\n          userId:1,\r\n          content:\"小米12s系列，徕卡影像，7月4日见\"\r\n\r\n        },\r\n        {\r\n          id:2,\r\n          userId:1,\r\n          content:\"小米手环7Pro，时尚新选择，7月4日见\"\r\n\r\n        },\r\n        {\r\n          id:3,\r\n          userId:1,\r\n          content:\"小米汽车c1，性价比轿跑，7月4日见\"\r\n\r\n        },\r\n\r\n\r\n\r\n\r\n\r\n\r\n      ]*/\r\n\r\n    });\r\n    $.ajax({\r\n      url:\"https://app165.acapp.acwing.com.cn/myspace/getinfo/\",\r\n      type:\"GET\",\r\n      data:{\r\n        user_id:userId,\r\n\r\n      },\r\n      headers:{\r\n        'Authorization': \"Bearer \" +store.state.user.access,\r\n      },\r\n      success(resp){\r\n        user.id=resp.id;\r\n        user.username=resp.username;\r\n        user.photo=resp.photo;\r\n        user.followerCount=resp.followerCount;\r\n        user.is_followed=resp.is_followed;//指的是当前登录的用户是否关注当前正在看的用户\r\n        //console.log(resp);\r\n      },\r\n      error(){\r\n        console.log(\"failed\");\r\n      }\r\n\r\n\r\n    });\r\n    $.ajax({\r\n      url:\"https://app165.acapp.acwing.com.cn/myspace/post/\",\r\n      type:\"GET\",\r\n      data:{\r\n        user_id:userId\r\n      },\r\n      headers:{\r\n        'Authorization': \"Bearer \" +store.state.user.access,\r\n      },\r\n      success(resp){\r\n        posts.count=resp.length;\r\n        posts.posts=resp;\r\n        //console.log(resp);\r\n      },\r\n      error(){\r\n        console.log(\"failed\");\r\n      }\r\n\r\n\r\n    });\r\n    const follow=()=>{\r\n      if(user.is_followed)return;//已经关注就无需重复关注\r\n      user.is_followed=true;\r\n      user.followerCount++;\r\n\r\n    };\r\n    const unfollow=()=>{\r\n      if(!user.is_followed)return;//已经取消关注就无需取消关注\r\n      user.is_followed=false;//否则取消关注并且关注数减一\r\n      user.followerCount--;\r\n\r\n    };\r\n    //发布一个帖子\r\n    const post_a_post=(content)=>{\r\n      posts.count++;\r\n      posts.posts.unshift({\r\n        id:posts.count,\r\n        userId:1,\r\n        content:content,\r\n      })\r\n    };\r\n    //删除一个帖子\r\n    const delete_a_post=(post_id)=>{\r\n      posts.posts=posts.posts.filter(posts=>posts.id!=post_id);//过滤，判断该元素是否应该被保留下来\r\n      posts.count=posts.posts.length;\r\n\r\n\r\n\r\n    };\r\n    /*const change_a_post=(post_id)=>{\r\n\r\n    };*/\r\n\r\n    //判断当前页面是不是自己\r\n    //console.log(typeof(userId),typeof(store.state.user.id));\r\n    const is_me=computed(()=>userId===store.state.user.id);\r\n    return {\r\n      user,\r\n      follow,\r\n      unfollow,\r\n      posts,\r\n      post_a_post,\r\n      delete_a_post,\r\n      is_me,\r\n\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}